#!/bin/bash

SCRIPT_ABS_PATH="$( readlink -f "$0" )"
CDINOUT_ROOT="${SCRIPT_ABS_PATH%/*}"

CDINOUT_SCRIPTS_PATH="$HOME/.config/cdinout/paths"

p="$1"
[ -z "$p" ] && p="$( pwd )"
[ "$p" = "$CDINOUT_ROOT" ] && { echo "no path specified"; exit 1; }

TARGET_PATH="$CDINOUT_SCRIPTS_PATH/$p"

mkdir -p "$TARGET_PATH"

_paths() {
    printf "# autogenerated\
        \n# $p \
        \n# $p/bin \
        \n# $p/.workspace \
        \n# $p/.workspace/bin \
        \n\n" >"$1"
}

_create_in_file() {
    _paths "$TARGET_PATH/in.sh"
    cat "$CDINOUT_ROOT/sample/in.sh.sample" >> "$TARGET_PATH/in.sh"
}

_create_out_file() {
    _paths "$TARGET_PATH/out.sh"
    cat "$CDINOUT_ROOT/sample/out.sh.sample" >> "$TARGET_PATH/out.sh"
}

[ -f "$TARGET_PATH/in.sh" ] || _create_in_file
[ -f "$TARGET_PATH/out.sh" ] || _create_out_file
